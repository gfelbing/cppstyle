#!/usr/bin/env python3.5

import sys, errno
from cppstyle import check_naming, check_order, utils
from cppstyle.model import parser

if __name__ == "__main__":
    args = utils.args()
    config = utils.config(args.config)

    for file in args.files:
        root = parser.parse(file)
        issues = []
        issues += check_naming.check(file, root, config)
        issues += check_order.check(file, root, config)
        if len(issues) > 0:
            print("Found issues in file '{}':".format(file))
            for issue in issues:
                print("    {}".format(issue))
            sys.exit(errno.EFAULT)
